"use strict";define(function(require,exports,module){var dbHelper,escaper=require("js/escaper.js"),IndexDBHelper=require("js/IndexDBHelper.js"),storeName="Notes",databaseName="NoteApp";dbHelper=new IndexDBHelper,dbHelper.openDatabase(databaseName,storeName,!1,function(omes){omes.success||alert(omes.msg)});var ListContainer=require("js/ListContainer.js");mui.plusReady(function(){ReactDOM.render(React.createElement(SettingContainer,null),mui(".container")[0])}),function(){Date.prototype.Format=function(fmt){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(fmt)&&(fmt=fmt.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var k in o)new RegExp("("+k+")").test(fmt)&&(fmt=fmt.replace(RegExp.$1,1==RegExp.$1.length?o[k]:("00"+o[k]).substr((""+o[k]).length)));return fmt}}();var SettingContainer=React.createClass({displayName:"SettingContainer",getInitialState:function(){var hasLocker=plus.storage.getItem("Locker"),switchState=!1;return hasLocker&&"enable"==hasLocker&&(switchState=!0),{items:[{isNode:!0,disName:"产品",items:[{disName:"IOS1",link:"tab-webview-subpage-setting.html"},{disName:"IOS",link:"http://192.168.91.101:811/"},{disName:"IOS",link:"#"}]},{isNode:!1,disName:"备份到文件",handler:function(){var now=new Date;dbHelper.find(storeName,{},!0,function(mes){if(mes.success){var notes=mes.result;if(notes.sort(function(a,b){var kA=a.id,kB=b.id;return kB>kA?1:-1}),notes.length<=0)return void alert("没有可备份的记录");var ui=plus.nativeUI.showWaiting("正在备份"+notes.length+"条记录...",{back:"none"});plus.io.requestFileSystem(plus.io.PUBLIC_DOWNLOADS,function(fs){var fileName=now.Format("yyyy-MM-dd hh-mm-ss")+".txt",filePath=fs.root.fullPath+fileName;fs.root.getFile(fileName,{create:!0},function(fileEntry){fileEntry.file(function(file){fileEntry.createWriter(function(writer){try{var temp="";notes.forEach(function(note,index){temp+=note.id+"^^^"+note.createon+"^^^"+escaper.decodeSpc(note.content)+"\r\n"}),writer.write(temp.substring(0,temp.length-3))}catch(e){alert("备份失败")}ui.close(),alert("备份成功:"+filePath)},function(e){alert(e.message)})})})},function(e){alert("Request file system failed: "+e.message)})}else alert(mes.msg)})}},{isNode:!1,disName:"启用手势",link:"#",items:[],"switch":!0,switchState:switchState,handler:function(){var state=mui(".toggleLocker")[0].classList.contains("mui-active")?"enable":"disable";if(plus.storage.setItem("Locker",state),"enable"==state){var pass=plus.storage.getItem("LockerPass");if(null==pass){var curView=plus.webview.currentWebview();curView.loadURL("appsetting-locker.html?reset=true")}}}},{isNode:!1,disName:"设置手势",link:"appsetting-locker.html?reset=true",hidden:!0}]}},render:function(){return React.createElement("div",null,React.createElement("header",{className:"mui-bar mui-bar-nav"},React.createElement("a",{className:"mui-icon mui-icon-left-nav mui-pull-left"}),React.createElement("h1",{className:"mui-title"},"设置")),React.createElement("div",{className:"mui-content"},React.createElement(ListContainer,{items:this.state.items})))}})});
//# sourceMappingURL=AppSetting.js.map